<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>AfraidOfAelmo</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
    onload="renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '$', right: '$', display: false}
      ]
    });">
</script>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>AfraidOfAelmo | My New Hugo Site</title>
<meta name="keywords" content="">
<meta name="description" content="Zero-Knowledge Challenge Write-up
The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the witness.
The Script:
FLAG  = os.getenv(&#34;FLAG&#34;, &#34;Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}&#34;).encode()


class ZKP:
    def __init__(self):
        self.p = getPrime(256)
        self.q = getPrime(256) 
        self.g = 2
        self.w = b2l(FLAG) 
        self.y = pow(self.g, self.w, self.p)
    def prover(self):
            r = randbelow(1 &lt;&lt; 200)
            a = pow(self.g, r, self.p)
            e = randbelow(1 &lt;&lt; 256)
            z = (r &#43; self.w * e) % self.q
            proof = {&#34;a&#34;: a, &#34;e&#34;: e, &#34;z&#34;: z}
            return proof
    def __str__(self):
        return f&#34;ZKP PUBLIC PARAMETERS:\np = {self.p}\nq = {self.q}\ng = {self.g}\ny = {self.y}&#34;

user = ZKP()

menu = &#34;&#34;&#34;
[1] Prover
[2] Exit
&#34;&#34;&#34;
def main():
    ctr = 0
    print(user)
    print(f&#39;hint: {b2l(FLAG).bit_length()}...you\&#39;re welcome :)&#39;)

    while True:
        print(menu)
        choice = input(&#34;Select an option &gt; &#34;)
        if choice == &#39;1&#39;:
            if ctr &gt;= 6:
                print(&#34;You have reached the maximum number of proofs.&#34;)
                continue
            
            print(&#34;Prover selected.&#34;)
            print(f&#39;Here is your proof: {user.prover()}&#39;)
            ctr &#43;= 1

        elif choice == &#39;2&#39;:
            print(&#34;Goodbye!&#34;)
            break
        else:
            print(&#34;Invalid option. Please try again.&#34;)

if __name__ == &#34;__main__&#34;:
    main()
This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the commitment , $e$ is the challenge and $z$ is the response of the prover.">
<meta name="author" content="">
<link rel="canonical" href="https://pi-1337.github.io/crypto-writeups/posts/afraidofaelmo/">
<link crossorigin="anonymous" href="/crypto-writeups/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css" integrity="sha256-2jIR5e&#43;Ge/K3X9WmUVz&#43;1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://pi-1337.github.io/crypto-writeups/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://pi-1337.github.io/crypto-writeups/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://pi-1337.github.io/crypto-writeups/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://pi-1337.github.io/crypto-writeups/apple-touch-icon.png">
<link rel="mask-icon" href="https://pi-1337.github.io/crypto-writeups/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://pi-1337.github.io/crypto-writeups/posts/afraidofaelmo/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://pi-1337.github.io/crypto-writeups/posts/afraidofaelmo/">
  <meta property="og:site_name" content="My New Hugo Site">
  <meta property="og:title" content="AfraidOfAelmo">
  <meta property="og:description" content="Zero-Knowledge Challenge Write-up The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the witness.
The Script: FLAG = os.getenv(&#34;FLAG&#34;, &#34;Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}&#34;).encode() class ZKP: def __init__(self): self.p = getPrime(256) self.q = getPrime(256) self.g = 2 self.w = b2l(FLAG) self.y = pow(self.g, self.w, self.p) def prover(self): r = randbelow(1 &lt;&lt; 200) a = pow(self.g, r, self.p) e = randbelow(1 &lt;&lt; 256) z = (r &#43; self.w * e) % self.q proof = {&#34;a&#34;: a, &#34;e&#34;: e, &#34;z&#34;: z} return proof def __str__(self): return f&#34;ZKP PUBLIC PARAMETERS:\np = {self.p}\nq = {self.q}\ng = {self.g}\ny = {self.y}&#34; user = ZKP() menu = &#34;&#34;&#34; [1] Prover [2] Exit &#34;&#34;&#34; def main(): ctr = 0 print(user) print(f&#39;hint: {b2l(FLAG).bit_length()}...you\&#39;re welcome :)&#39;) while True: print(menu) choice = input(&#34;Select an option &gt; &#34;) if choice == &#39;1&#39;: if ctr &gt;= 6: print(&#34;You have reached the maximum number of proofs.&#34;) continue print(&#34;Prover selected.&#34;) print(f&#39;Here is your proof: {user.prover()}&#39;) ctr &#43;= 1 elif choice == &#39;2&#39;: print(&#34;Goodbye!&#34;) break else: print(&#34;Invalid option. Please try again.&#34;) if __name__ == &#34;__main__&#34;: main() This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the commitment , $e$ is the challenge and $z$ is the response of the prover.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2026-02-03T00:00:00+00:00">
    <meta property="article:modified_time" content="2026-02-03T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AfraidOfAelmo">
<meta name="twitter:description" content="Zero-Knowledge Challenge Write-up
The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the witness.
The Script:
FLAG  = os.getenv(&#34;FLAG&#34;, &#34;Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}&#34;).encode()


class ZKP:
    def __init__(self):
        self.p = getPrime(256)
        self.q = getPrime(256) 
        self.g = 2
        self.w = b2l(FLAG) 
        self.y = pow(self.g, self.w, self.p)
    def prover(self):
            r = randbelow(1 &lt;&lt; 200)
            a = pow(self.g, r, self.p)
            e = randbelow(1 &lt;&lt; 256)
            z = (r &#43; self.w * e) % self.q
            proof = {&#34;a&#34;: a, &#34;e&#34;: e, &#34;z&#34;: z}
            return proof
    def __str__(self):
        return f&#34;ZKP PUBLIC PARAMETERS:\np = {self.p}\nq = {self.q}\ng = {self.g}\ny = {self.y}&#34;

user = ZKP()

menu = &#34;&#34;&#34;
[1] Prover
[2] Exit
&#34;&#34;&#34;
def main():
    ctr = 0
    print(user)
    print(f&#39;hint: {b2l(FLAG).bit_length()}...you\&#39;re welcome :)&#39;)

    while True:
        print(menu)
        choice = input(&#34;Select an option &gt; &#34;)
        if choice == &#39;1&#39;:
            if ctr &gt;= 6:
                print(&#34;You have reached the maximum number of proofs.&#34;)
                continue
            
            print(&#34;Prover selected.&#34;)
            print(f&#39;Here is your proof: {user.prover()}&#39;)
            ctr &#43;= 1

        elif choice == &#39;2&#39;:
            print(&#34;Goodbye!&#34;)
            break
        else:
            print(&#34;Invalid option. Please try again.&#34;)

if __name__ == &#34;__main__&#34;:
    main()
This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the commitment , $e$ is the challenge and $z$ is the response of the prover.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://pi-1337.github.io/crypto-writeups/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "AfraidOfAelmo",
      "item": "https://pi-1337.github.io/crypto-writeups/posts/afraidofaelmo/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "AfraidOfAelmo",
  "name": "AfraidOfAelmo",
  "description": "Zero-Knowledge Challenge Write-up The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the witness.\nThe Script: FLAG = os.getenv(\u0026#34;FLAG\u0026#34;, \u0026#34;Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}\u0026#34;).encode() class ZKP: def __init__(self): self.p = getPrime(256) self.q = getPrime(256) self.g = 2 self.w = b2l(FLAG) self.y = pow(self.g, self.w, self.p) def prover(self): r = randbelow(1 \u0026lt;\u0026lt; 200) a = pow(self.g, r, self.p) e = randbelow(1 \u0026lt;\u0026lt; 256) z = (r + self.w * e) % self.q proof = {\u0026#34;a\u0026#34;: a, \u0026#34;e\u0026#34;: e, \u0026#34;z\u0026#34;: z} return proof def __str__(self): return f\u0026#34;ZKP PUBLIC PARAMETERS:\\np = {self.p}\\nq = {self.q}\\ng = {self.g}\\ny = {self.y}\u0026#34; user = ZKP() menu = \u0026#34;\u0026#34;\u0026#34; [1] Prover [2] Exit \u0026#34;\u0026#34;\u0026#34; def main(): ctr = 0 print(user) print(f\u0026#39;hint: {b2l(FLAG).bit_length()}...you\\\u0026#39;re welcome :)\u0026#39;) while True: print(menu) choice = input(\u0026#34;Select an option \u0026gt; \u0026#34;) if choice == \u0026#39;1\u0026#39;: if ctr \u0026gt;= 6: print(\u0026#34;You have reached the maximum number of proofs.\u0026#34;) continue print(\u0026#34;Prover selected.\u0026#34;) print(f\u0026#39;Here is your proof: {user.prover()}\u0026#39;) ctr += 1 elif choice == \u0026#39;2\u0026#39;: print(\u0026#34;Goodbye!\u0026#34;) break else: print(\u0026#34;Invalid option. Please try again.\u0026#34;) if __name__ == \u0026#34;__main__\u0026#34;: main() This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the commitment , $e$ is the challenge and $z$ is the response of the prover.\n",
  "keywords": [
    
  ],
  "articleBody": "Zero-Knowledge Challenge Write-up The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the witness.\nThe Script: FLAG = os.getenv(\"FLAG\", \"Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}\").encode() class ZKP: def __init__(self): self.p = getPrime(256) self.q = getPrime(256) self.g = 2 self.w = b2l(FLAG) self.y = pow(self.g, self.w, self.p) def prover(self): r = randbelow(1 \u003c\u003c 200) a = pow(self.g, r, self.p) e = randbelow(1 \u003c\u003c 256) z = (r + self.w * e) % self.q proof = {\"a\": a, \"e\": e, \"z\": z} return proof def __str__(self): return f\"ZKP PUBLIC PARAMETERS:\\np = {self.p}\\nq = {self.q}\\ng = {self.g}\\ny = {self.y}\" user = ZKP() menu = \"\"\" [1] Prover [2] Exit \"\"\" def main(): ctr = 0 print(user) print(f'hint: {b2l(FLAG).bit_length()}...you\\'re welcome :)') while True: print(menu) choice = input(\"Select an option \u003e \") if choice == '1': if ctr \u003e= 6: print(\"You have reached the maximum number of proofs.\") continue print(\"Prover selected.\") print(f'Here is your proof: {user.prover()}') ctr += 1 elif choice == '2': print(\"Goodbye!\") break else: print(\"Invalid option. Please try again.\") if __name__ == \"__main__\": main() This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the commitment , $e$ is the challenge and $z$ is the response of the prover.\nThe straight-forward attack vector is to recover $r$ from $a$ and use it to recover the witness. But since recovering $r$ from $a$ is an instance of the DLP in $\\mathbb{F}_p$ (Discrete Logarithm problem on a finite field), and DLP is considered a hard problem, then this approach is not feasible.\nLLL : The key here is that the random generated number $r$ is bounded by $(1 Â« 200)$ or $2^{200}$ while the modulus q is much larger (256 bits), this tells us that we can treat the number $r$ as the error term in the Hidden Number Problem (HNP) equation, and with enough equation we may be able to recover the secret which is the witness using Lattice Reduction Technique . So:\n$$z = (r + w \\cdot e) \\bmod q$$ Becomes the HNP equation. we just need enough samples of $(z, e)$, it turns out 6 samples are enough. enough to recover the $w \\bmod q$.\nCRT : Doing this only gets the witness mod q, also note that we can do this over and over by closing the connection and restarting it, and of course with different primes. Thus allowing as to recover the full witness using Chinese Remainder Theorem (CRT) which states that given equations :\n$$ x \\equiv a_1 \\pmod{m_1} \\ $$\n$$ x \\equiv a_2 \\pmod{m_2} \\ $$\n$$ \\vdots \\ $$\n$$ x \\equiv a_k \\pmod{m_k} $$\nOne can recover $x$ Uniquely using CRT which is already implemented in sagemath, so the final script is this, its an extension of this script https://github.com/josephsurin/lattice-based-cryptanalysis/blob/main/examples/problems/hidden_number_problem.sage :\nfrom Crypto.Util.number import long_to_bytes data = [{}] # this is got from the data script below def hnp_example(q, proofs): B = 1 \u003c\u003c 200 T = [] A = [] for d in proofs: T.append(d[\"e\"]) A.append(d[\"z\"]) sol = hnp(q, T, A, B, verbose=True) print(\"Recovered solution:\", sol) w_mod_q = sol % q return w_mod_q, q reminders = [] modulues = [] for session in data: wq, mod = hnp_example(session[\"q\"], session[\"proofs\"]) reminders.append(wq) modulues.append(mod) W = crt(reminders, modulues) print(\"Recovered w bitlen:\", int(W).bit_length()) print(\"Recovered FLAG:\") print(long_to_bytes(W)) I used this repo [[https://github.com/josephsurin/lattice-based-cryptanalysis]] .\nDATA : This is the script to get data from the server in python : ChatGPT did good job here.\nfrom pwn import * import re import ast HOST = \"4786170ad621653c.chal.ctf.ae\" PORT = 443 def collect_all(): sessions = [] for S in range(40): print(f\"[+] Starting session {S+1}/10\") s = remote(HOST, PORT, ssl=True, sni=HOST) banner = s.recvuntil(b\"[2] Exit\").decode() # --------------------------- # Extract metadata # --------------------------- md = {} md[\"p\"] = int(re.search(r\"p = (\\d+)\", banner).group(1)) md[\"q\"] = int(re.search(r\"q = (\\d+)\", banner).group(1)) md[\"g\"] = int(re.search(r\"g = (\\d+)\", banner).group(1)) md[\"y\"] = int(re.search(r\"y = (\\d+)\", banner).group(1)) md[\"bitlen\"] = int(re.search(r\"hint: (\\d+)\", banner).group(1)) md[\"proofs\"] = [] # --------------------------- # Get 6 proofs # --------------------------- for i in range(6): s.sendline(b\"1\") line = s.recvline_contains(b\"proof\").decode() # Extract dict {\"a\":..., \"e\":..., \"z\":...} proof_dict = ast.literal_eval(line.split(\"proof:\")[1].strip()) md[\"proofs\"].append({ \"a\": proof_dict[\"a\"], \"e\": proof_dict[\"e\"], \"z\": proof_dict[\"z\"] }) s.close() sessions.append(md) return sessions if name == \"main\": data = collect_all() print(\"\\n=== FIRST SESSION ===\") print(data) print(f\"\\n[+] Total sessions collected: {len(data)}\") print(\"[+] Each session contains its own parameters + 6 proofs.\") ",
  "wordCount" : "894",
  "inLanguage": "en",
  "datePublished": "2026-02-03T00:00:00Z",
  "dateModified": "2026-02-03T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://pi-1337.github.io/crypto-writeups/posts/afraidofaelmo/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "My New Hugo Site",
    "logo": {
      "@type": "ImageObject",
      "url": "https://pi-1337.github.io/crypto-writeups/favicon.ico"
    }
  }
}
</script></head>
<body><header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://pi-1337.github.io/crypto-writeups/" accesskey="h" title="My New Hugo Site (Alt + H)">My New Hugo Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">
    

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      AfraidOfAelmo
    </h1>
    <div class="post-meta"><span title='2026-02-03 00:00:00 +0000 UTC'>February 3, 2026</span>

</div>
  </header> 
  <div class="post-content"><h1 id="zero-knowledge-challenge-write-up">Zero-Knowledge Challenge Write-up<a hidden class="anchor" aria-hidden="true" href="#zero-knowledge-challenge-write-up">#</a></h1>
<p>The the challenge is a Zero Knowledge Scheme, where the server tries to prove to the player their knowledge of a witness $w$ (which is the flag), without revealing the <em>witness</em>.</p>
<h1 id="the-script">The Script:<a hidden class="anchor" aria-hidden="true" href="#the-script">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>FLAG  <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getenv(<span style="color:#e6db74">&#34;FLAG&#34;</span>, <span style="color:#e6db74">&#34;Lorem ipsum dolor sit amet consectetur adipiscing elit. Pretium tellus duis convallis tempus leo eu aenean. Iaculis massa nisl malesuada lacinia integer nunc posuere. Conubia nostra inceptos himenaeos orci varius natoque penatibus. Nulla molestie mattis scelerisque maximus eget fermentum odio. Blandit quis suspendisse aliquet nisi sodales consequat magna. Ligula congue sollicitudin erat viverra ac tincidunt nam. Velit aliquam imperdiet mollis nullam volutpat porttitor ullamcorper. Dui felis venenatis ultrices proin libero feugiat tristique. Cubilia curae hac habitasse platea dictumst lorem ipsum. Sem placerat in id cursus mi pretium tellus. Fringilla lacus nec metus bibendum egestas iaculis massa. Taciti sociosqu ad litora torquent per conubia nostra. Ridiculus mus donec rhoncus eros lobortis nulla molestie. Mauris pharetra vestibulum fusce dictum risus blandit quis. Finibus facilisis dapibus etiam interdum tortor ligula congue. Justo lectus commodo augue arcu dignissim velit aliquam. Primis vulputate ornare sagittis vehicula praesent dui felis. Senectus netus suscipit auctor curabitur facilisi cubilia curae. Quisque faucibus ex sapien vitae pellentesque sem placerat. flag{dGhpbmtfeW91J3JlX3NtYXJ0X2h1aD8=}&#34;</span>)<span style="color:#f92672">.</span>encode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ZKP</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__init__</span>(self):
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>p <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>q <span style="color:#f92672">=</span> getPrime(<span style="color:#ae81ff">256</span>) 
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>g <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>w <span style="color:#f92672">=</span> b2l(FLAG) 
</span></span><span style="display:flex;"><span>        self<span style="color:#f92672">.</span>y <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>g, self<span style="color:#f92672">.</span>w, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">prover</span>(self):
</span></span><span style="display:flex;"><span>            r <span style="color:#f92672">=</span> randbelow(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">200</span>)
</span></span><span style="display:flex;"><span>            a <span style="color:#f92672">=</span> pow(self<span style="color:#f92672">.</span>g, r, self<span style="color:#f92672">.</span>p)
</span></span><span style="display:flex;"><span>            e <span style="color:#f92672">=</span> randbelow(<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">256</span>)
</span></span><span style="display:flex;"><span>            z <span style="color:#f92672">=</span> (r <span style="color:#f92672">+</span> self<span style="color:#f92672">.</span>w <span style="color:#f92672">*</span> e) <span style="color:#f92672">%</span> self<span style="color:#f92672">.</span>q
</span></span><span style="display:flex;"><span>            proof <span style="color:#f92672">=</span> {<span style="color:#e6db74">&#34;a&#34;</span>: a, <span style="color:#e6db74">&#34;e&#34;</span>: e, <span style="color:#e6db74">&#34;z&#34;</span>: z}
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> proof
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">__str__</span>(self):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;ZKP PUBLIC PARAMETERS:</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">p = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>p<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">q = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>q<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">g = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>g<span style="color:#e6db74">}</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">y = </span><span style="color:#e6db74">{</span>self<span style="color:#f92672">.</span>y<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>user <span style="color:#f92672">=</span> ZKP()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>menu <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[1] Prover
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">[2] Exit
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">main</span>():
</span></span><span style="display:flex;"><span>    ctr <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    print(user)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;hint: </span><span style="color:#e6db74">{</span>b2l(FLAG)<span style="color:#f92672">.</span>bit_length()<span style="color:#e6db74">}</span><span style="color:#e6db74">...you</span><span style="color:#ae81ff">\&#39;</span><span style="color:#e6db74">re welcome :)&#39;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>        print(menu)
</span></span><span style="display:flex;"><span>        choice <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;Select an option &gt; &#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> choice <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;1&#39;</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> ctr <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">6</span>:
</span></span><span style="display:flex;"><span>                print(<span style="color:#e6db74">&#34;You have reached the maximum number of proofs.&#34;</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;Prover selected.&#34;</span>)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#39;Here is your proof: </span><span style="color:#e6db74">{</span>user<span style="color:#f92672">.</span>prover()<span style="color:#e6db74">}</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>            ctr <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> choice <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;2&#39;</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;Goodbye!&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;Invalid option. Please try again.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    main()
</span></span></code></pre></div><p>This is a Zero-knowledge Scheme, the $witness$ is $w$ and proof is consisted of $(a, e, z)$, where a $a$ is the <em>commitment</em> , $e$ is the <em>challenge</em> and $z$ is the <em>response</em> of the prover.</p>
<p>The straight-forward attack vector is to recover $r$ from $a$ and use it to recover the <em>witness</em>. But since recovering $r$ from $a$ is an instance of the DLP in $\mathbb{F}_p$ <em>(Discrete Logarithm problem on a finite field)</em>, and DLP is considered a hard problem, then this approach is not feasible.</p>
<h1 id="lll-">LLL :<a hidden class="anchor" aria-hidden="true" href="#lll-">#</a></h1>
<p>The key here is that the random generated number $r$ is bounded by $(1 &laquo; 200)$ or $2^{200}$ while the modulus q is much larger (256 bits), this tells us that we can treat the number $r$ as the error term in the <em>Hidden Number Problem</em> (HNP) equation, and with enough equation we may be able to recover the secret which is the <em>witness</em> using  <em>Lattice Reduction Technique</em> . So:</p>
<p>$$z = (r + w \cdot e) \bmod q$$
Becomes the HNP equation. we just need enough samples of $(z, e)$, it turns out 6 samples are enough. enough to recover the $w \bmod q$.</p>
<h1 id="crt-">CRT :<a hidden class="anchor" aria-hidden="true" href="#crt-">#</a></h1>
<p>Doing this only gets the witness mod q, also note that we can do this over and over by closing the connection and restarting it, and of course with different primes. Thus allowing as to recover the full witness using <em>Chinese Remainder Theorem</em> (CRT) which states that given equations :</p>
<p>$$
x \equiv a_1 \pmod{m_1} \
$$</p>
<p>$$
x \equiv a_2 \pmod{m_2} \
$$</p>
<p>$$
\vdots \
$$</p>
<p>$$
x \equiv a_k \pmod{m_k}
$$</p>
<p>One can recover $x$ Uniquely using CRT which is already implemented in sagemath, so the final script is this, its an extension of this script <a href="https://github.com/josephsurin/lattice-based-cryptanalysis/blob/main/examples/problems/hidden_number_problem.sage">https://github.com/josephsurin/lattice-based-cryptanalysis/blob/main/examples/problems/hidden_number_problem.sage</a> :</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> Crypto.Util.number <span style="color:#f92672">import</span> long_to_bytes
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>data <span style="color:#f92672">=</span> [{}] <span style="color:#75715e"># this is got from the data script below</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hnp_example</span>(q, proofs):
</span></span><span style="display:flex;"><span>    B <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> <span style="color:#ae81ff">200</span>
</span></span><span style="display:flex;"><span>    T <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    A <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> d <span style="color:#f92672">in</span> proofs:
</span></span><span style="display:flex;"><span>        T<span style="color:#f92672">.</span>append(d[<span style="color:#e6db74">&#34;e&#34;</span>])
</span></span><span style="display:flex;"><span>        A<span style="color:#f92672">.</span>append(d[<span style="color:#e6db74">&#34;z&#34;</span>])
</span></span><span style="display:flex;"><span>    sol <span style="color:#f92672">=</span> hnp(q, T, A, B, verbose<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Recovered solution:&#34;</span>, sol)
</span></span><span style="display:flex;"><span>    w_mod_q <span style="color:#f92672">=</span> sol <span style="color:#f92672">%</span> q
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> w_mod_q, q
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>reminders <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>modulues <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> session <span style="color:#f92672">in</span> data:
</span></span><span style="display:flex;"><span>    wq, mod <span style="color:#f92672">=</span> hnp_example(session[<span style="color:#e6db74">&#34;q&#34;</span>], session[<span style="color:#e6db74">&#34;proofs&#34;</span>])
</span></span><span style="display:flex;"><span>    reminders<span style="color:#f92672">.</span>append(wq)
</span></span><span style="display:flex;"><span>    modulues<span style="color:#f92672">.</span>append(mod)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>W <span style="color:#f92672">=</span> crt(reminders, modulues)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Recovered w bitlen:&#34;</span>, int(W)<span style="color:#f92672">.</span>bit_length())
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;Recovered FLAG:&#34;</span>)
</span></span><span style="display:flex;"><span>print(long_to_bytes(W))
</span></span></code></pre></div><p>I used this repo [[https://github.com/josephsurin/lattice-based-cryptanalysis]] .</p>
<h1 id="data-">DATA :<a hidden class="anchor" aria-hidden="true" href="#data-">#</a></h1>
<p>This is the script to get data from the server in python :
ChatGPT did good job here.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> ast
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>HOST <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;4786170ad621653c.chal.ctf.ae&#34;</span>
</span></span><span style="display:flex;"><span>PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">443</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">collect_all</span>():
</span></span><span style="display:flex;"><span>    sessions <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> S <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">40</span>):
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;[+] Starting session </span><span style="color:#e6db74">{</span>S<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#e6db74">}</span><span style="color:#e6db74">/10&#34;</span>)
</span></span><span style="display:flex;"><span>        s <span style="color:#f92672">=</span> remote(HOST, PORT, ssl<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, sni<span style="color:#f92672">=</span>HOST)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        banner <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;[2] Exit&#34;</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------------------</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Extract metadata</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------------------</span>
</span></span><span style="display:flex;"><span>        md <span style="color:#f92672">=</span> {}
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;p&#34;</span>] <span style="color:#f92672">=</span> int(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;p = (\d+)&#34;</span>, banner)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;q&#34;</span>] <span style="color:#f92672">=</span> int(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;q = (\d+)&#34;</span>, banner)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;g&#34;</span>] <span style="color:#f92672">=</span> int(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;g = (\d+)&#34;</span>, banner)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;y&#34;</span>] <span style="color:#f92672">=</span> int(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;y = (\d+)&#34;</span>, banner)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;bitlen&#34;</span>] <span style="color:#f92672">=</span> int(re<span style="color:#f92672">.</span>search(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;hint: (\d+)&#34;</span>, banner)<span style="color:#f92672">.</span>group(<span style="color:#ae81ff">1</span>))
</span></span><span style="display:flex;"><span>        md[<span style="color:#e6db74">&#34;proofs&#34;</span>] <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------------------</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># Get 6 proofs</span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e"># ---------------------------</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">6</span>):
</span></span><span style="display:flex;"><span>            s<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>            line <span style="color:#f92672">=</span> s<span style="color:#f92672">.</span>recvline_contains(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;proof&#34;</span>)<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e"># Extract dict {&#34;a&#34;:..., &#34;e&#34;:..., &#34;z&#34;:...}</span>
</span></span><span style="display:flex;"><span>            proof_dict <span style="color:#f92672">=</span> ast<span style="color:#f92672">.</span>literal_eval(line<span style="color:#f92672">.</span>split(<span style="color:#e6db74">&#34;proof:&#34;</span>)[<span style="color:#ae81ff">1</span>]<span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            md[<span style="color:#e6db74">&#34;proofs&#34;</span>]<span style="color:#f92672">.</span>append({
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;a&#34;</span>: proof_dict[<span style="color:#e6db74">&#34;a&#34;</span>],
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;e&#34;</span>: proof_dict[<span style="color:#e6db74">&#34;e&#34;</span>],
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;z&#34;</span>: proof_dict[<span style="color:#e6db74">&#34;z&#34;</span>]
</span></span><span style="display:flex;"><span>            })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        s<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        sessions<span style="color:#f92672">.</span>append(md)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sessions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;main&#34;</span>:
</span></span><span style="display:flex;"><span>    data <span style="color:#f92672">=</span> collect_all()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">=== FIRST SESSION ===&#34;</span>)
</span></span><span style="display:flex;"><span>    print(data)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">[+] Total sessions collected: </span><span style="color:#e6db74">{</span>len(data)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;[+] Each session contains its own parameters + 6 proofs.&#34;</span>)
</span></span></code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
  </main>
<footer class="footer">
        <span>&copy; 2026 <a href="https://pi-1337.github.io/crypto-writeups/">My New Hugo Site</a></span> Â· 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>
</html>

